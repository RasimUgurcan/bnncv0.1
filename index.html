<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>CanlÄ± Kripto Paneli</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">

  <style>
    body { font-family: Arial, sans-serif; background:#0e0e0e; color:#fff; }
    table.dataTable { background:#1a1a1a; border-radius:8px; }
    .buy { color:#0f0; font-weight:bold; }
    .sell { color:#f00; font-weight:bold; }
  </style>
</head>
<body>
  <h2>ðŸ“ˆ CanlÄ± Kripto Paneli</h2>
  <table id="cryptoTable" class="display" style="width:100%">
    <thead>
      <tr>
        <th>Coin</th>
        <th>Fiyat</th>
        <th>Sinyal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let table = $('#cryptoTable').DataTable();

    // Takip edilecek coinler
    let symbols = ["btcusdt","ethusdt","bnbusdt","xrpusdt","solusdt"];

    // Binance Ã§oklu stream
    let streams = symbols.map(s => s + "@trade").join("/");
    let ws = new WebSocket(`wss://stream.binance.com:9443/stream?streams=${streams}`);

    // FiyatlarÄ± hafÄ±zada tut
    let prices = {};

    ws.onmessage = function(event) {
      let msg = JSON.parse(event.data);
      let symbol = msg.stream.split("@")[0].toUpperCase();
      let price = parseFloat(msg.data.p).toFixed(2);

      // Ã–nceki fiyatÄ± al
      let prev = prices[symbol] || price;
      prices[symbol] = price;

      // YÃ¶n belirle
      let signalClass = price > prev ? "buy" : "sell";
      let signalText  = signalClass === "buy" ? "AL" : "SAT";

      // Tabloya ekle/gÃ¼ncelle
      let row = table.row(function(idx, data, node) {
        return data[0] === symbol;
      });

      if (row.node()) {
        row.data([symbol, `$${price}`, `<span class="${signalClass}">${signalText}</span>`]).draw(false);
      } else {
        table.row.add([symbol, `$${price}`, `<span class="${signalClass}">${signalText}</span>`]).draw(false);
      }
    };
  </script>
</body>
</html>
